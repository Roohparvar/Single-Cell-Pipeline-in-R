geom_vline(xintercept=4500, color='red')
dev.off()
srobj_10=subset(srobj_10,subset=nFeature_RNA>800 & nFeature_RNA<4500 & MTpercent<19 & nCount_RNA>1600 & nCount_RNA<18000)
################################################################################ End +CPI no colitis NC2 #10
################################################################################ Start +CPI no colitis NC3 #11
setwd("C:/Esmaeil/scRNA-seq/Single-Cell-Pipeline-in-R/Data/CD3/+CPI no colitis/GSM4288836_NC3-CD3-genes-barcodes-matrix")
CountMatrix=Read10X("C:/Esmaeil/scRNA-seq/Single-Cell-Pipeline-in-R/Data/CD3/+CPI no colitis/GSM4288836_NC3-CD3-genes-barcodes-matrix")
srobj_11=CreateSeuratObject(CountMatrix,project ="+CPI no colitis NC3",min.cells=3,min.features=200)
srobj_11[["MTpercent"]]=PercentageFeatureSet(srobj_11,pattern = "^MT-")
png(filename = "1.png",width = 10000,height=4000,units ="px",res = 600)
ggplot(data = srobj_11@meta.data, aes(x = srobj_11$nCount_RNA, y = srobj_11$MTpercent)) +
geom_point(size = 2, color = 'blue') +
labs(x = 'nCount_RNA', y = 'perc. mito') +
scale_x_log10() +
geom_hline(yintercept = 20, color = 'red') +
geom_vline(xintercept = 1600, color = 'red') +
geom_vline(xintercept = 18000, color = 'red')
dev.off()
png(filename = "2.png",width = 10000,height=4000,units ="px",res = 600)
ggplot(data=srobj_11@meta.data, aes(x=srobj_11$nFeature_RNA, y=srobj_11$MTpercent)) +
geom_point(size=2, color = 'blue') +
labs(x='nFeature_RNA', y='perc. mito') +
scale_x_log10() +
geom_hline(yintercept=20, color='red') +
geom_vline(xintercept=800, color='red') +
geom_vline(xintercept=4200, color='red')
dev.off()
srobj_11=subset(srobj_11,subset=nFeature_RNA>800 & nFeature_RNA<4200 & MTpercent<20 & nCount_RNA>1600 & nCount_RNA<18000)
################################################################################ End +CPI no colitis NC3 #11
################################################################################ Start +CPI no colitis NC4 #12
setwd("C:/Esmaeil/scRNA-seq/Single-Cell-Pipeline-in-R/Data/CD3/+CPI no colitis/GSM4288837_NC4-CD3-genes-barcodes-matrix")
CountMatrix=Read10X("C:/Esmaeil/scRNA-seq/Single-Cell-Pipeline-in-R/Data/CD3/+CPI no colitis/GSM4288837_NC4-CD3-genes-barcodes-matrix")
srobj_12=CreateSeuratObject(CountMatrix,project ="+CPI no colitis NC4",min.cells=3,min.features=200)
srobj_12[["MTpercent"]]=PercentageFeatureSet(srobj_12,pattern = "^MT-")
png(filename = "1.png",width = 10000,height=4000,units ="px",res = 600)
ggplot(data = srobj_12@meta.data, aes(x = srobj_12$nCount_RNA, y = srobj_12$MTpercent)) +
geom_point(size = 2, color = 'blue') +
labs(x = 'nCount_RNA', y = 'perc. mito') +
scale_x_log10() +
geom_hline(yintercept = 20, color = 'red') +
geom_vline(xintercept = 1600, color = 'red') +
geom_vline(xintercept = 18000, color = 'red')
dev.off()
png(filename = "2.png",width = 10000,height=4000,units ="px",res = 600)
ggplot(data=srobj_12@meta.data, aes(x=srobj_12$nFeature_RNA, y=srobj_12$MTpercent)) +
geom_point(size=2, color = 'blue') +
labs(x='nFeature_RNA', y='perc. mito') +
scale_x_log10() +
geom_hline(yintercept=20, color='red') +
geom_vline(xintercept=800, color='red') +
geom_vline(xintercept=4200, color='red')
dev.off()
srobj_12=subset(srobj_12,subset=nFeature_RNA>800 & nFeature_RNA<4200 & MTpercent<20 & nCount_RNA>1600 & nCount_RNA<18000)
################################################################################ End +CPI no colitis NC4 #12
################################################################################ Start +CPI no colitis NC5 #13
setwd("C:/Esmaeil/scRNA-seq/Single-Cell-Pipeline-in-R/Data/CD3/+CPI no colitis/GSM4288838_NC5-CD3-genes-barcodes-matrix")
CountMatrix=Read10X("C:/Esmaeil/scRNA-seq/Single-Cell-Pipeline-in-R/Data/CD3/+CPI no colitis/GSM4288838_NC5-CD3-genes-barcodes-matrix")
srobj_13=CreateSeuratObject(CountMatrix,project ="+CPI no colitis NC5",min.cells=3,min.features=200)
srobj_13[["MTpercent"]]=PercentageFeatureSet(srobj_13,pattern = "^MT-")
png(filename = "1.png",width = 10000,height=4000,units ="px",res = 600)
ggplot(data = srobj_13@meta.data, aes(x = srobj_13$nCount_RNA, y = srobj_13$MTpercent)) +
geom_point(size = 2, color = 'blue') +
labs(x = 'nCount_RNA', y = 'perc. mito') +
scale_x_log10() +
geom_hline(yintercept = 23, color = 'red') +
geom_vline(xintercept = 1600, color = 'red') +
geom_vline(xintercept = 22000, color = 'red')
dev.off()
png(filename = "2.png",width = 10000,height=4000,units ="px",res = 600)
ggplot(data=srobj_13@meta.data, aes(x=srobj_13$nFeature_RNA, y=srobj_13$MTpercent)) +
geom_point(size=2, color = 'blue') +
labs(x='nFeature_RNA', y='perc. mito') +
scale_x_log10() +
geom_hline(yintercept=23, color='red') +
geom_vline(xintercept=900, color='red') +
geom_vline(xintercept=5000, color='red')
dev.off()
srobj_13=subset(srobj_13,subset=nFeature_RNA>900 & nFeature_RNA<5000 & MTpercent<23 & nCount_RNA>1600 & nCount_RNA<22000)
################################################################################ End +CPI no colitis NC5 #13
################################################################################ Start +CPI no colitis NC6 #14
setwd("C:/Esmaeil/scRNA-seq/Single-Cell-Pipeline-in-R/Data/CD3/+CPI no colitis/GSM4288839_NC6-CD3-genes-barcodes-matrix")
CountMatrix=Read10X("C:/Esmaeil/scRNA-seq/Single-Cell-Pipeline-in-R/Data/CD3/+CPI no colitis/GSM4288839_NC6-CD3-genes-barcodes-matrix")
srobj_14=CreateSeuratObject(CountMatrix,project ="+CPI no colitis NC6",min.cells=3,min.features=200)
srobj_14[["MTpercent"]]=PercentageFeatureSet(srobj_14,pattern = "^MT-")
png(filename = "1.png",width = 10000,height=4000,units ="px",res = 600)
ggplot(data = srobj_14@meta.data, aes(x = srobj_14$nCount_RNA, y = srobj_14$MTpercent)) +
geom_point(size = 2, color = 'blue') +
labs(x = 'nCount_RNA', y = 'perc. mito') +
scale_x_log10() +
geom_hline(yintercept = 21, color = 'red') +
geom_vline(xintercept = 1400, color = 'red') +
geom_vline(xintercept = 21000, color = 'red')
dev.off()
png(filename = "2.png",width = 10000,height=4000,units ="px",res = 600)
ggplot(data=srobj_14@meta.data, aes(x=srobj_14$nFeature_RNA, y=srobj_14$MTpercent)) +
geom_point(size=2, color = 'blue') +
labs(x='nFeature_RNA', y='perc. mito') +
scale_x_log10() +
geom_hline(yintercept=21, color='red') +
geom_vline(xintercept=600, color='red') +
geom_vline(xintercept=5000, color='red')
dev.off()
srobj_14=subset(srobj_14,subset=nFeature_RNA>600 & nFeature_RNA<5000 & MTpercent<21 & nCount_RNA>1400 & nCount_RNA<21000)
################################################################################ End +CPI no colitis NC6 #14
################################################################################ Start +CPI colitis C1 #15
setwd("C:/Esmaeil/scRNA-seq/Single-Cell-Pipeline-in-R/Data/CD3/+CPI colitis/GSM4288826_C1-CD3-genes-barcodes-matrix")
CountMatrix=Read10X("C:/Esmaeil/scRNA-seq/Single-Cell-Pipeline-in-R/Data/CD3/+CPI colitis/GSM4288826_C1-CD3-genes-barcodes-matrix")
srobj_15=CreateSeuratObject(CountMatrix,project ="+CPI colitis C1",min.cells=3,min.features=200)
srobj_15[["MTpercent"]]=PercentageFeatureSet(srobj_15,pattern = "^MT-")
png(filename = "1.png",width = 10000,height=4000,units ="px",res = 600)
ggplot(data = srobj_15@meta.data, aes(x = srobj_15$nCount_RNA, y = srobj_15$MTpercent)) +
geom_point(size = 2, color = 'blue') +
labs(x = 'nCount_RNA', y = 'perc. mito') +
scale_x_log10() +
geom_hline(yintercept = 25, color = 'red') +
geom_vline(xintercept = 1600, color = 'red') +
geom_vline(xintercept = 30000, color = 'red')
dev.off()
png(filename = "2.png",width = 10000,height=4000,units ="px",res = 600)
ggplot(data=srobj_15@meta.data, aes(x=srobj_15$nFeature_RNA, y=srobj_15$MTpercent)) +
geom_point(size=2, color = 'blue') +
labs(x='nFeature_RNA', y='perc. mito') +
scale_x_log10() +
geom_hline(yintercept=25, color='red') +
geom_vline(xintercept=800, color='red') +
geom_vline(xintercept=6200, color='red')
dev.off()
srobj_15=subset(srobj_15,subset=nFeature_RNA>800 & nFeature_RNA<6200 & MTpercent<25 & nCount_RNA>1600 & nCount_RNA<30000)
################################################################################ End +CPI colitis C1 #15
################################################################################ Start +CPI colitis C2 #16
setwd("C:/Esmaeil/scRNA-seq/Single-Cell-Pipeline-in-R/Data/CD3/+CPI colitis/GSM4288827_C2-CD3-genes-barcodes-matrix")
CountMatrix=Read10X("C:/Esmaeil/scRNA-seq/Single-Cell-Pipeline-in-R/Data/CD3/+CPI colitis/GSM4288827_C2-CD3-genes-barcodes-matrix")
srobj_16=CreateSeuratObject(CountMatrix,project ="+CPI colitis C2",min.cells=3,min.features=200)
srobj_16[["MTpercent"]]=PercentageFeatureSet(srobj_16,pattern = "^MT-")
png(filename = "1.png",width = 10000,height=4000,units ="px",res = 600)
ggplot(data = srobj_16@meta.data, aes(x = srobj_16$nCount_RNA, y = srobj_16$MTpercent)) +
geom_point(size = 2, color = 'blue') +
labs(x = 'nCount_RNA', y = 'perc. mito') +
scale_x_log10() +
geom_hline(yintercept = 20, color = 'red') +
geom_vline(xintercept = 1600, color = 'red') +
geom_vline(xintercept = 37000, color = 'red')
dev.off()
png(filename = "2.png",width = 10000,height=4000,units ="px",res = 600)
ggplot(data=srobj_16@meta.data, aes(x=srobj_16$nFeature_RNA, y=srobj_16$MTpercent)) +
geom_point(size=2, color = 'blue') +
labs(x='nFeature_RNA', y='perc. mito') +
scale_x_log10() +
geom_hline(yintercept=20, color='red') +
geom_vline(xintercept=900, color='red') +
geom_vline(xintercept=6200, color='red')
dev.off()
srobj_16=subset(srobj_16,subset=nFeature_RNA>900 & nFeature_RNA<6200 & MTpercent<20 & nCount_RNA>1600 & nCount_RNA<37000)
################################################################################ End +CPI colitis C2 #16
################################################################################ Start +CPI colitis C3 #17
setwd("C:/Esmaeil/scRNA-seq/Single-Cell-Pipeline-in-R/Data/CD3/+CPI colitis/GSM4288828_C3-CD3-genes-barcodes-matrix")
CountMatrix=Read10X("C:/Esmaeil/scRNA-seq/Single-Cell-Pipeline-in-R/Data/CD3/+CPI colitis/GSM4288828_C3-CD3-genes-barcodes-matrix")
srobj_17=CreateSeuratObject(CountMatrix,project ="+CPI colitis C3",min.cells=3,min.features=200)
srobj_17[["MTpercent"]]=PercentageFeatureSet(srobj_17,pattern = "^MT-")
png(filename = "1.png",width = 10000,height=4000,units ="px",res = 600)
ggplot(data = srobj_17@meta.data, aes(x = srobj_17$nCount_RNA, y = srobj_17$MTpercent)) +
geom_point(size = 2, color = 'blue') +
labs(x = 'nCount_RNA', y = 'perc. mito') +
scale_x_log10() +
geom_hline(yintercept = 20, color = 'red') +
geom_vline(xintercept = 1400, color = 'red') +
geom_vline(xintercept = 37000, color = 'red')
dev.off()
png(filename = "2.png",width = 10000,height=4000,units ="px",res = 600)
ggplot(data=srobj_17@meta.data, aes(x=srobj_17$nFeature_RNA, y=srobj_17$MTpercent)) +
geom_point(size=2, color = 'blue') +
labs(x='nFeature_RNA', y='perc. mito') +
scale_x_log10() +
geom_hline(yintercept=20, color='red') +
geom_vline(xintercept=800, color='red') +
geom_vline(xintercept=6200, color='red')
dev.off()
srobj_17=subset(srobj_17,subset=nFeature_RNA>800 & nFeature_RNA<6200 & MTpercent<20 & nCount_RNA>1400 & nCount_RNA<37000)
################################################################################ End +CPI colitis C3 #17
################################################################################ Start +CPI colitis C4 #18
setwd("C:/Esmaeil/scRNA-seq/Single-Cell-Pipeline-in-R/Data/CD3/+CPI colitis/GSM4288829_C4-CD3-genes-barcodes-matrix")
CountMatrix=Read10X("C:/Esmaeil/scRNA-seq/Single-Cell-Pipeline-in-R/Data/CD3/+CPI colitis/GSM4288829_C4-CD3-genes-barcodes-matrix")
srobj_18=CreateSeuratObject(CountMatrix,project ="+CPI colitis C4",min.cells=3,min.features=200)
srobj_18[["MTpercent"]]=PercentageFeatureSet(srobj_18,pattern = "^MT-")
png(filename = "1.png",width = 10000,height=4000,units ="px",res = 600)
ggplot(data = srobj_18@meta.data, aes(x = srobj_18$nCount_RNA, y = srobj_18$MTpercent)) +
geom_point(size = 2, color = 'blue') +
labs(x = 'nCount_RNA', y = 'perc. mito') +
scale_x_log10() +
geom_hline(yintercept = 20, color = 'red') +
geom_vline(xintercept = 1400, color = 'red') +
geom_vline(xintercept = 37000, color = 'red')
dev.off()
png(filename = "2.png",width = 10000,height=4000,units ="px",res = 600)
ggplot(data=srobj_18@meta.data, aes(x=srobj_18$nFeature_RNA, y=srobj_18$MTpercent)) +
geom_point(size=2, color = 'blue') +
labs(x='nFeature_RNA', y='perc. mito') +
scale_x_log10() +
geom_hline(yintercept=20, color='red') +
geom_vline(xintercept=800, color='red') +
geom_vline(xintercept=6200, color='red')
dev.off()
srobj_18=subset(srobj_18,subset=nFeature_RNA>800 & nFeature_RNA<6200 & MTpercent<20 & nCount_RNA>1400 & nCount_RNA<37000)
################################################################################ End +CPI colitis C4 #18
################################################################################ Start +CPI colitis C5 #19
setwd("C:/Esmaeil/scRNA-seq/Single-Cell-Pipeline-in-R/Data/CD3/+CPI colitis/GSM4288830_C5-CD3-genes-barcodes-matrix")
CountMatrix=Read10X("C:/Esmaeil/scRNA-seq/Single-Cell-Pipeline-in-R/Data/CD3/+CPI colitis/GSM4288830_C5-CD3-genes-barcodes-matrix")
srobj_19=CreateSeuratObject(CountMatrix,project ="+CPI colitis C5",min.cells=3,min.features=200)
srobj_19[["MTpercent"]]=PercentageFeatureSet(srobj_19,pattern = "^MT-")
png(filename = "1.png",width = 10000,height=4000,units ="px",res = 600)
ggplot(data = srobj_19@meta.data, aes(x = srobj_19$nCount_RNA, y = srobj_19$MTpercent)) +
geom_point(size = 2, color = 'blue') +
labs(x = 'nCount_RNA', y = 'perc. mito') +
scale_x_log10() +
geom_hline(yintercept = 17, color = 'red') +
geom_vline(xintercept = 1400, color = 'red') +
geom_vline(xintercept = 37000, color = 'red')
dev.off()
png(filename = "2.png",width = 10000,height=4000,units ="px",res = 600)
ggplot(data=srobj_19@meta.data, aes(x=srobj_19$nFeature_RNA, y=srobj_19$MTpercent)) +
geom_point(size=2, color = 'blue') +
labs(x='nFeature_RNA', y='perc. mito') +
scale_x_log10() +
geom_hline(yintercept=17, color='red') +
geom_vline(xintercept=800, color='red') +
geom_vline(xintercept=5600, color='red')
dev.off()
srobj_19=subset(srobj_19,subset=nFeature_RNA>800 & nFeature_RNA<5600 & MTpercent<17 & nCount_RNA>1400 & nCount_RNA<37000)
################################################################################ End +CPI colitis C5 #19
################################################################################ Start +CPI colitis C6 #20
setwd("C:/Esmaeil/scRNA-seq/Single-Cell-Pipeline-in-R/Data/CD3/+CPI colitis/GSM4288831_C6-CD3-genes-barcodes-matrix")
CountMatrix=Read10X("C:/Esmaeil/scRNA-seq/Single-Cell-Pipeline-in-R/Data/CD3/+CPI colitis/GSM4288831_C6-CD3-genes-barcodes-matrix")
srobj_20=CreateSeuratObject(CountMatrix,project ="+CPI colitis C6",min.cells=3,min.features=200)
srobj_20[["MTpercent"]]=PercentageFeatureSet(srobj_20,pattern = "^MT-")
png(filename = "1.png",width = 10000,height=4000,units ="px",res = 600)
ggplot(data = srobj_20@meta.data, aes(x = srobj_20$nCount_RNA, y = srobj_20$MTpercent)) +
geom_point(size = 2, color = 'blue') +
labs(x = 'nCount_RNA', y = 'perc. mito') +
scale_x_log10() +
geom_hline(yintercept = 20, color = 'red') +
geom_vline(xintercept = 1400, color = 'red') +
geom_vline(xintercept = 37000, color = 'red')
dev.off()
png(filename = "2.png",width = 10000,height=4000,units ="px",res = 600)
ggplot(data=srobj_20@meta.data, aes(x=srobj_20$nFeature_RNA, y=srobj_20$MTpercent)) +
geom_point(size=2, color = 'blue') +
labs(x='nFeature_RNA', y='perc. mito') +
scale_x_log10() +
geom_hline(yintercept=20, color='red') +
geom_vline(xintercept=800, color='red') +
geom_vline(xintercept=5600, color='red')
dev.off()
srobj_20=subset(srobj_20,subset=nFeature_RNA>800 & nFeature_RNA<5600 & MTpercent<20 & nCount_RNA>1400 & nCount_RNA<37000)
################################################################################ End +CPI colitis C6 #20
################################################################################ Start +CPI colitis C7 #21
setwd("C:/Esmaeil/scRNA-seq/Single-Cell-Pipeline-in-R/Data/CD3/+CPI colitis/GSM4288832_C7-CD3-genes-barcodes-matrix")
CountMatrix=Read10X("C:/Esmaeil/scRNA-seq/Single-Cell-Pipeline-in-R/Data/CD3/+CPI colitis/GSM4288832_C7-CD3-genes-barcodes-matrix")
srobj_21=CreateSeuratObject(CountMatrix,project ="+CPI colitis C7",min.cells=3,min.features=200)
srobj_21[["MTpercent"]]=PercentageFeatureSet(srobj_21,pattern = "^MT-")
png(filename = "1.png",width = 10000,height=4000,units ="px",res = 600)
ggplot(data = srobj_21@meta.data, aes(x = srobj_21$nCount_RNA, y = srobj_21$MTpercent)) +
geom_point(size = 2, color = 'blue') +
labs(x = 'nCount_RNA', y = 'perc. mito') +
scale_x_log10() +
geom_hline(yintercept = 18, color = 'red') +
geom_vline(xintercept = 1600, color = 'red') +
geom_vline(xintercept = 43000, color = 'red')
dev.off()
png(filename = "2.png",width = 10000,height=4000,units ="px",res = 600)
ggplot(data=srobj_21@meta.data, aes(x=srobj_21$nFeature_RNA, y=srobj_21$MTpercent)) +
geom_point(size=2, color = 'blue') +
labs(x='nFeature_RNA', y='perc. mito') +
scale_x_log10() +
geom_hline(yintercept=18, color='red') +
geom_vline(xintercept=800, color='red') +
geom_vline(xintercept=6500, color='red')
dev.off()
srobj_21=subset(srobj_21,subset=nFeature_RNA>800 & nFeature_RNA<6500 & MTpercent<18 & nCount_RNA>1600 & nCount_RNA<43000)
################################################################################ End +CPI colitis C7 #21
################################################################################ Start +CPI colitis C8 #22
setwd("C:/Esmaeil/scRNA-seq/Single-Cell-Pipeline-in-R/Data/CD3/+CPI colitis/GSM4288833_C8-CD3-genes-barcodes-matrix")
CountMatrix=Read10X("C:/Esmaeil/scRNA-seq/Single-Cell-Pipeline-in-R/Data/CD3/+CPI colitis/GSM4288833_C8-CD3-genes-barcodes-matrix")
srobj_22=CreateSeuratObject(CountMatrix,project ="+CPI colitis C8",min.cells=3,min.features=200)
srobj_22[["MTpercent"]]=PercentageFeatureSet(srobj_22,pattern = "^MT-")
png(filename = "1.png",width = 10000,height=4000,units ="px",res = 600)
ggplot(data = srobj_22@meta.data, aes(x = srobj_22$nCount_RNA, y = srobj_22$MTpercent)) +
geom_point(size = 2, color = 'blue') +
labs(x = 'nCount_RNA', y = 'perc. mito') +
scale_x_log10() +
geom_hline(yintercept = 25, color = 'red') +
geom_vline(xintercept = 1100, color = 'red') +
geom_vline(xintercept = 47000, color = 'red')
dev.off()
png(filename = "2.png",width = 10000,height=4000,units ="px",res = 600)
ggplot(data=srobj_22@meta.data, aes(x=srobj_22$nFeature_RNA, y=srobj_22$MTpercent)) +
geom_point(size=2, color = 'blue') +
labs(x='nFeature_RNA', y='perc. mito') +
scale_x_log10() +
geom_hline(yintercept=25, color='red') +
geom_vline(xintercept=800, color='red') +
geom_vline(xintercept=6500, color='red')
dev.off()
srobj_22=subset(srobj_22,subset=nFeature_RNA>800 & nFeature_RNA<6500 & MTpercent<25 & nCount_RNA>1100 & nCount_RNA<47000)
################################################################################ End +CPI colitis C8 #22
setwd("C:/Esmaeil/scRNA-seq/Single-Cell-Pipeline-in-R/integrated_obj Data")
merged_obj <- merge(srobj_1, y = list(srobj_2, srobj_3, srobj_4,
srobj_5, srobj_6, srobj_7,
srobj_8, srobj_9,srobj_10,
srobj_11, srobj_12,srobj_13,
srobj_14, srobj_15,srobj_16,
srobj_17, srobj_18,srobj_19,
srobj_20, srobj_21,srobj_22))
merged_obj=NormalizeData(merged_obj,normalization.method = "LogNormalize",scale.factor = 10000)
merged_obj=FindVariableFeatures(merged_obj,selection.method = "vst",nfeatures = 2000)
merged_obj=subset(merged_obj, features = VariableFeatures(merged_obj))
merged_obj = ScaleData(merged_obj,features = rownames(merged_obj))
merged_obj = RunPCA(merged_obj)
getwd()
saveRDS(file = "merged_obj",merged_obj)
merged_obj <- IntegrateLayers(object = merged_obj,
method = CCAIntegration,
orig.reduction = "pca",
new.reduction = "integrated.cca",
verbose = FALSE)
saveRDS(file = "merged_obj",merged_obj)
merged_obj[["RNA"]] <- JoinLayers(merged_obj[["RNA"]])
png(filename = "ElbowPlot.png",width = 10000,height=4000,units ="px",res = 600)
ElbowPlot(merged_obj,ndims = 50)
dev.off()
merged_obj1 = merged_obj
merged_obj1=FindNeighbors(merged_obj1,dims = 1:20,reduction = "integrated.cca")
merged_obj1=FindClusters(merged_obj1,resolution = 0.2)
# 3
saveRDS(file = "merged_obj1",merged_obj1)
merged_obj1=RunUMAP(merged_obj1,dims = 1:20, reduction = "integrated.cca")
png(filename = "UMAP1.png",width = 10000,height=4000,units ="px",res = 600 )
DimPlot(merged_obj1,label = TRUE)
dev.off()
?FindNeighbors
?ElbowPlot
png(filename = "ElbowPlot2.png",width = 10000,height=4000,units ="px",res = 600)
ElbowPlot(merged_obj,ndims = 50,reduction = "integrated.cca")
merged_obj1 = merged_obj
merged_obj1 = merged_obj
merged_obj1=FindNeighbors(merged_obj1,dims = 1:30,reduction = "integrated.cca")
merged_obj1=FindClusters(merged_obj1,resolution = 0.2)
saveRDS(file = "merged_obj1",merged_obj1)
merged_obj1=RunUMAP(merged_obj1,dims = 1:30, reduction = "integrated.cca")
png(filename = "UMAP1.png",width = 10000,height=4000,units ="px",res = 600 )
DimPlot(merged_obj1,label = TRUE)
dev.off()
# Remove clusters 10
merged_obj1 <- subset(merged_obj1, subset = seurat_clusters %in% c(10), invert = TRUE)
png(filename = "UMAP2.png",width = 10000,height=4000,units ="px",res = 600 )
DimPlot(merged_obj1,label = TRUE)
dev.off()
# UMAP projection of all cells colored by their original sample ID (orig.ident).
png(filename = "UMAP_BySampleID.png",width = 10000,height=4000,units ="px",res = 600 )
DimPlot(merged_obj1, reduction = "integrated.cca", group.by = "orig.ident")
dev.off()
# UMAP projection of all cells colored by their original sample ID (orig.ident).
png(filename = "UMAP_BySampleID.png",width = 10000,height=4000,units ="px",res = 600 )
DimPlot(merged_obj1, group.by = "orig.ident")
dev.off()
# UMAP projection split by original sample ID. Each panel shows the cells of one sample with their spatial distribution in the integrated UMAP space.
png(filename = "UMAP_SplitBySample.png",width = 25000,height=4000,units ="px",res = 600 )
DimPlot(merged_obj1, split.by = "orig.ident")
dev.off()
# UMAP projection split by original sample ID. Each panel shows the cells of one sample with their spatial distribution in the integrated UMAP space.
png(filename = "UMAP_SplitBySample.png",width = 28000,height=4000,units ="px",res = 600 )
DimPlot(merged_obj1, split.by = "orig.ident")
dev.off()
png(filename = "UMAP_by_Group.png", width = 10000, height = 4000, units = "px", res = 600)
DimPlot(merged_obj1, split.by = "group", label = TRUE)
normal_control <- paste0("srobj_", 1:8)
cpi_no_colitis <- paste0("srobj_", 9:14)
cpi_colitis <- paste0("srobj_", 15:22)
merged_obj1$group <- ifelse(merged_obj1$orig.ident %in% normal_control, "Normal_Control",
ifelse(merged_obj1$orig.ident %in% cpi_no_colitis, "+CPI_no_colitis", "+CPI_colitis"))
png(filename = "UMAP_by_Group.png", width = 10000, height = 4000, units = "px", res = 600)
DimPlot(merged_obj1, split.by = "group", label = TRUE)
dev.off()
normal_control <- paste0("srobj_", 1:8)
cpi_no_colitis <- paste0("srobj_", 9:14)
cpi_colitis <- paste0("srobj_", 15:22)
merged_obj1$group <- ifelse(merged_obj1$orig.ident %in% normal_control, "Normal_Control",
ifelse(merged_obj1$orig.ident %in% cpi_no_colitis, "+CPI_no_colitis", "+CPI_colitis"))
View(merged_obj1)
merged_obj1@meta.data[["group"]]
png(filename = "UMAP_by_Group2.png", width = 10000, height = 4000, units = "px", res = 600)
DimPlot(merged_obj1, split.by = "group", label = TRUE)
dev.off()
png(filename = "UMAP_by_Group_colors45.png", width = 10000, height = 4000, units = "px", res = 600)
DimPlot(merged_obj1, label = TRUE)
dev.off()
Idents(merged_obj1) <- "group"
png(filename = "UMAP_by_Group_colors45.png", width = 10000, height = 4000, units = "px", res = 600)
DimPlot(merged_obj1, label = TRUE)
dev.off()
table(merged_obj1$orig.ident)
normal_samples <- c("Normal Control CT1", "Normal Control CT2", "Normal Control CT3", "Normal Control CT4",
"Normal Control CT5", "Normal Control CT6", "Normal Control CT7", "Normal Control CT8")
cpi_no_colitis_samples <- c("+CPI no colitis NC1", "+CPI no colitis NC2", "+CPI no colitis NC3",
"+CPI no colitis NC4", "+CPI no colitis NC5", "+CPI no colitis NC6")
cpi_colitis_samples <- c("+CPI colitis C1", "+CPI colitis C2", "+CPI colitis C3", "+CPI colitis C4",
"+CPI colitis C5", "+CPI colitis C6", "+CPI colitis C7", "+CPI colitis C8")
# ساخت ستون group بر اساس orig.ident
merged_obj1$group <- ifelse(merged_obj1$orig.ident %in% normal_samples, "Normal_Control",
ifelse(merged_obj1$orig.ident %in% cpi_no_colitis_samples, "+CPI_no_colitis", "+CPI_colitis"))
# رسم UMAP به تفکیک گروه‌ها
png(filename = "UMAP_by_Group.png", width = 10000, height = 4000, units = "px", res = 600)
DimPlot(merged_obj1, split.by = "group", label = TRUE)
dev.off()
normal_samples <- c("Normal Control CT1", "Normal Control CT2", "Normal Control CT3", "Normal Control CT4",
"Normal Control CT5", "Normal Control CT6", "Normal Control CT7", "Normal Control CT8")
cpi_no_colitis_samples <- c("+CPI no colitis NC1", "+CPI no colitis NC2", "+CPI no colitis NC3",
"+CPI no colitis NC4", "+CPI no colitis NC5", "+CPI no colitis NC6")
cpi_colitis_samples <- c("+CPI colitis C1", "+CPI colitis C2", "+CPI colitis C3", "+CPI colitis C4",
"+CPI colitis C5", "+CPI colitis C6", "+CPI colitis C7", "+CPI colitis C8")
# ساخت ستون group بر اساس orig.ident
merged_obj1$group <- ifelse(merged_obj1$orig.ident %in% normal_samples, "Normal_Control",
ifelse(merged_obj1$orig.ident %in% cpi_no_colitis_samples, "+CPI_no_colitis", "+CPI_colitis"))
# رسم UMAP به تفکیک گروه‌ها
png(filename = "UMAP_by_Group.png", width = 10000, height = 4000, units = "px", res = 600)
DimPlot(merged_obj1, split.by = "group", label = TRUE)
dev.off()
# تعیین نام نمونه‌ها برای هر گروه
normal_samples <- c("Normal Control CT1", "Normal Control CT2", "Normal Control CT3", "Normal Control CT4",
"Normal Control CT5", "Normal Control CT6", "Normal Control CT7", "Normal Control CT8")
cpi_no_colitis_samples <- c("+CPI no colitis NC1", "+CPI no colitis NC2", "+CPI no colitis NC3",
"+CPI no colitis NC4", "+CPI no colitis NC5", "+CPI no colitis NC6")
cpi_colitis_samples <- c("+CPI colitis C1", "+CPI colitis C2", "+CPI colitis C3", "+CPI colitis C4",
"+CPI colitis C5", "+CPI colitis C6", "+CPI colitis C7", "+CPI colitis C8")
# ساخت ستون گروه
merged_obj1$group <- ifelse(merged_obj1$orig.ident %in% normal_samples, "Normal_Control",
ifelse(merged_obj1$orig.ident %in% cpi_no_colitis_samples, "+CPI_no_colitis", "+CPI_colitis"))
# رسم UMAP با رنگ‌های متفاوت برای گروه‌ها در یک نمودار
png(filename = "UMAP_AllGroups_Together.png", width = 10000, height = 4000, units = "px", res = 600)
DimPlot(merged_obj1, group.by = "group", label = TRUE)
dev.off()
# تعیین نام نمونه‌ها برای هر گروه
normal_samples <- c("Normal Control CT1", "Normal Control CT2", "Normal Control CT3", "Normal Control CT4",
"Normal Control CT5", "Normal Control CT6", "Normal Control CT7", "Normal Control CT8")
cpi_no_colitis_samples <- c("+CPI no colitis NC1", "+CPI no colitis NC2", "+CPI no colitis NC3",
"+CPI no colitis NC4", "+CPI no colitis NC5", "+CPI no colitis NC6")
cpi_colitis_samples <- c("+CPI colitis C1", "+CPI colitis C2", "+CPI colitis C3", "+CPI colitis C4",
"+CPI colitis C5", "+CPI colitis C6", "+CPI colitis C7", "+CPI colitis C8")
# ساخت ستون گروه
merged_obj1$group <- ifelse(merged_obj1$orig.ident %in% normal_samples, "Normal_Control",
ifelse(merged_obj1$orig.ident %in% cpi_no_colitis_samples, "+CPI_no_colitis", "+CPI_colitis"))
# رسم UMAP با رنگ‌های متفاوت برای گروه‌ها در یک نمودار
png(filename = "UMAP_AllGroups_Together.png", width = 10000, height = 4000, units = "px", res = 600)
DimPlot(merged_obj1, group.by = "group")
dev.off()
merged_obj2 = merged_obj1
saveRDS(file = "merged_obj2",merged_obj2)
merged_obj2 <- JoinLayers(merged_obj2)
markers = FindAllMarkers(merged_obj2,min.pct = 0.1 , logfc.threshold = 0.1)
write.csv(markers,file="AllMarkers.csv")
merged_obj2 <- JoinLayers(merged_obj2)
markers = FindAllMarkers(merged_obj2,min.pct = 0.1 , logfc.threshold = 0.1)
table(Idents(merged_obj2))
merged_obj1 = merged_obj
merged_obj1=FindNeighbors(merged_obj1,dims = 1:30,reduction = "integrated.cca")
merged_obj1=FindClusters(merged_obj1,resolution = 0.2)
merged_obj1=RunUMAP(merged_obj1,dims = 1:30, reduction = "integrated.cca")
png(filename = "UMAP1.png",width = 10000,height=4000,units ="px",res = 600 )
DimPlot(merged_obj1,label = TRUE)
dev.off()
# Remove clusters 10
merged_obj1 <- subset(merged_obj1, subset = seurat_clusters %in% c(10), invert = TRUE)
png(filename = "UMAP2.png",width = 10000,height=4000,units ="px",res = 600 )
DimPlot(merged_obj1,label = TRUE)
dev.off()
# UMAP projection of all cells colored by their original sample ID (orig.ident).
png(filename = "UMAP_BySampleID.png",width = 10000,height=4000,units ="px",res = 600 )
DimPlot(merged_obj1, group.by = "orig.ident")
dev.off()
# UMAP projection split by original sample ID. Each panel shows the cells of one sample with their spatial distribution in the integrated UMAP space.
png(filename = "UMAP_SplitBySample.png",width = 28000,height=4000,units ="px",res = 600 )
DimPlot(merged_obj1, split.by = "orig.ident")
dev.off()
merged_obj2 = merged_obj1
saveRDS(file = "merged_obj2",merged_obj2)
merged_obj2 <- JoinLayers(merged_obj2)
markers = FindAllMarkers(merged_obj2,min.pct = 0.1 , logfc.threshold = 0.1)
write.csv(markers,file="AllMarkers.csv")
saveRDS(file = "merged_obj3",merged_obj2)
# Dot Plot of Key Marker Genes Across All Clusters
png(filename = "DotPlot_Key_Markers_Across_All_Clusters.png",width = 10000,height=4000,units ="px",res = 600 )
DotPlot(merged_obj3, features = c("CD4", "CD40LG", "CD8A", "CD8B", "SELL", "CCR7", "IL7R", "CTLA4",
"FOXP3", "TNFRSF4", "TNFRSF18", "TIGIT", "IL2RA", "ICOS", "IFNG",
"STAT1", "STAT4", "TBX21", "GATA3", "STAT5", "STAT6", "IL17A", "RORA",
"LTB", "CD4A", "CD4B", "GNLY", "GZMA", "GZMB", "GZMH", "GZMK", "PRF1", "NKG7")) +
coord_flip()
merged_obj3 = merged_obj2
saveRDS(file = "merged_obj3",merged_obj3)
# Dot Plot of Key Marker Genes Across All Clusters
png(filename = "DotPlot_Key_Markers_Across_All_Clusters.png",width = 10000,height=4000,units ="px",res = 600 )
DotPlot(merged_obj3, features = c("CD4", "CD40LG", "CD8A", "CD8B", "SELL", "CCR7", "IL7R", "CTLA4",
"FOXP3", "TNFRSF4", "TNFRSF18", "TIGIT", "IL2RA", "ICOS", "IFNG",
"STAT1", "STAT4", "TBX21", "GATA3", "STAT5", "STAT6", "IL17A", "RORA",
"LTB", "CD4A", "CD4B", "GNLY", "GZMA", "GZMB", "GZMH", "GZMK", "PRF1", "NKG7")) +
coord_flip()
dev.off()
important_markers <- c("CD4", "CD40LG", "CD8A", "CD8B", "SELL", "CCR7", "IL7R", "CTLA4",
"FOXP3", "TNFRSF4", "TNFRSF18", "TIGIT", "IL2RA", "ICOS", "IFNG",
"STAT1", "STAT4", "TBX21", "GATA3", "STAT5", "STAT6", "IL17A", "RORA",
"LTB", "CD4A", "CD4B", "GNLY", "GZMA", "GZMB", "GZMH", "GZMK", "PRF1", "NKG7")
# Filtered Key Markers from All Identified Cluster Markers
filtered_markers <- markers[markers$gene %in% important_markers, ]
write.csv(filtered_markers,file="Filtered_Markers.csv")
