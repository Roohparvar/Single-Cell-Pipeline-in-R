library(Seurat)
library(SeuratObject)
library(ggplot2)
merged_obj2 = LoadSeuratRds(file="C:/Esmaeil/scRNA-seq/continue by this/merged_obj2")
# Filter for cluster 1
cluster_1_data <- subset(merged_obj2, seurat_clusters == 1)
# Create DotPlot with the sorted genes by expression in cluster 1
png(filename = "DotPlot_Cluster1.png", width = 10000, height = 4000, units ="px", res = 600)
DotPlot(cluster_1_data,
features = c("SELL", "CCR7", "IL2RA", "IFNG", "STAT4", "TBX21", "STAT5",
"STAT6", "CD4A", "CD4B", "GZMH", "GZMK", "GNLY", "GZMB", "GZMA",
"PRF1", "NKG7", "CD8B", "CD8A", "TIGIT", "TNFRSF18", "FOXP3",
"TNFRSF4", "CTLA4", "STAT1", "ICOS", "CD4", "GATA3", "RORA", "CD40LG",
"LTB", "IL7R")) +
coord_flip() +
scale_x_discrete(limits = rev(rownames(cluster_1_data)))  # Reverse the order to show higher expression first
dev.off()
getwd()
setwd("C:/Esmaeil/scRNA-seq/Single-Cell-Pipeline-in-R/integrated_obj Data")
# Filter for cluster 1
cluster_1_data <- subset(merged_obj2, seurat_clusters == 1)
# Create DotPlot with the sorted genes by expression in cluster 1
png(filename = "DotPlot_Cluster1.png", width = 10000, height = 4000, units ="px", res = 600)
DotPlot(cluster_1_data,
features = c("SELL", "CCR7", "IL2RA", "IFNG", "STAT4", "TBX21", "STAT5",
"STAT6", "CD4A", "CD4B", "GZMH", "GZMK", "GNLY", "GZMB", "GZMA",
"PRF1", "NKG7", "CD8B", "CD8A", "TIGIT", "TNFRSF18", "FOXP3",
"TNFRSF4", "CTLA4", "STAT1", "ICOS", "CD4", "GATA3", "RORA", "CD40LG",
"LTB", "IL7R")) +
coord_flip() +
#scale_x_discrete(limits = rev(rownames(cluster_1_data)))  # Reverse the order to show higher expression first
dev.off()
# Filter for cluster 1
cluster_1_data <- subset(merged_obj2, seurat_clusters == 1)
# Create DotPlot with the sorted genes by expression in cluster 1
png(filename = "DotPlot_Cluster1.png", width = 10000, height = 4000, units ="px", res = 600)
DotPlot(cluster_1_data,
features = c("SELL", "CCR7", "IL2RA", "IFNG", "STAT4", "TBX21", "STAT5",
"STAT6", "CD4A", "CD4B", "GZMH", "GZMK", "GNLY", "GZMB", "GZMA",
"PRF1", "NKG7", "CD8B", "CD8A", "TIGIT", "TNFRSF18", "FOXP3",
"TNFRSF4", "CTLA4", "STAT1", "ICOS", "CD4", "GATA3", "RORA", "CD40LG",
"LTB", "IL7R")) +
coord_flip() #+
#scale_x_discrete(limits = rev(rownames(cluster_1_data)))  # Reverse the order to show higher expression first
dev.off()
# Step 1: Filter cluster 1
cluster1 <- subset(merged_obj2, idents = "1")
# Step 2: List of genes
genes <- c("SELL","CCR7","IL2RA","IFNG","STAT4","TBX21","STAT5",
"STAT6","CD4A","CD4B","GZMH","GZMK","GNLY","GZMB","GZMA",
"PRF1","NKG7","CD8B","CD8A","TIGIT","TNFRSF18",
"FOXP3","TNFRSF4","CTLA4","STAT1","ICOS","CD4","GATA3","RORA","CD40LG","LTB","IL7R")
# Step 3: Get average expression per gene
avg_expr <- AverageExpression(cluster1, features = genes, return.seurat = FALSE)$RNA
gene_order <- names(sort(colMeans(avg_expr), decreasing = TRUE))
# Step 4: Plot with reordered genes
png(filename = "DotPlot_Cluster1_SortedByExpression.png", width = 10000, height = 4000, units ="px", res = 600)
DotPlot(cluster1, features = gene_order) + coord_flip()
# Filter for cluster 1
cluster_1_data <- subset(merged_obj2, seurat_clusters == 1)
# Create DotPlot with the sorted genes by expression in cluster 1
png(filename = "DotPlot_Cluster1.png", width = 10000, height = 4000, units ="px", res = 600)
DotPlot(cluster_1_data,
features = c("SELL", "CCR7", "IL2RA", "IFNG", "STAT4", "TBX21", "STAT5",
"STAT6", "CD4A", "CD4B", "GZMH", "GZMK", "GNLY", "GZMB", "GZMA",
"PRF1", "NKG7", "CD8B", "CD8A", "TIGIT", "TNFRSF18", "FOXP3",
"TNFRSF4", "CTLA4", "STAT1", "ICOS", "CD4", "GATA3", "RORA", "CD40LG",
"LTB", "IL7R")) +
coord_flip() #+
#scale_x_discrete(limits = rev(rownames(cluster_1_data)))  # Reverse the order to show higher expression first
dev.off()
# Filter for cluster 1
cluster_1_data <- subset(merged_obj2, seurat_clusters == 1)
# Create DotPlot with the sorted genes by expression in cluster 1
png(filename = "DotPlot_Cluster1.png", width = 10000, height = 4000, units ="px", res = 600)
DotPlot(cluster_1_data,
features = c("SELL", "CCR7", "IL2RA", "IFNG", "STAT4", "TBX21", "STAT5",
"STAT6", "CD4A", "CD4B", "GZMH", "GZMK", "GNLY", "GZMB", "GZMA",
"PRF1", "NKG7", "CD8B", "CD8A", "TIGIT", "TNFRSF18", "FOXP3",
"TNFRSF4", "CTLA4", "STAT1", "ICOS", "CD4", "GATA3", "RORA", "CD40LG",
"LTB", "IL7R")) +
coord_flip() #+
#scale_x_discrete(limits = rev(rownames(cluster_1_data)))  # Reverse the order to show higher expression first
dev.off()
library(Seurat)
library(SeuratObject)
library(ggplot2)
merged_obj2 = LoadSeuratRds(file="C:/Esmaeil/scRNA-seq/continue by this/merged_obj2")
merged_obj2 <- JoinLayers(merged_obj2)
markers = FindAllMarkers(merged_obj2,min.pct = 0.1 , logfc.threshold = 0.1)
class(markers)
saveRDS(markers, file = "C:/Esmaeil/scRNA-seq/markers.rds")
markers <- readRDS("C:/Esmaeil/scRNA-seq/markers.rds")
View(markers)
